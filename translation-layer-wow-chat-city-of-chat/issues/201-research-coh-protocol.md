# 102 - Research CoH Protocol Structure

## Status
- Phase: 1
- Priority: High
- Dependencies: None

---

## Current Behavior

No documentation exists about CoH's client-server protocol within
this project. While CoH has active private servers (Homecoming, etc.),
their protocol details are not yet captured here.

---

## Intended Behavior

A comprehensive document (`docs/coh-protocol.md`) should exist that covers:

1. **Packet structure** - Header format, message types, encoding
2. **Authentication flow** - Login, character selection, server transfer
3. **World data** - Zone instances, door missions, contacts
4. **Combat data** - Powers, damage, enhancements, buffs
5. **Social data** - Chat channels, teams, supergroups
6. **Character data** - Archetypes, powersets, slots, costumes
7. **Mastermind-specific** - Minion commands, pet AI states

Special attention to Mastermind class since the vision specifically
mentions wanting to play one in Outland.

---

## Suggested Implementation Steps

1. Research CoH private server implementations:
   - Homecoming server codebase (if accessible)
   - SEGS (Super Entity Game Server) project
   - i24/i25 server documentation

2. Focus on the Rogue Isles content:
   - Villain-side progression systems
   - Arachnos contact system
   - Patron power unlocks

3. Document packet format with examples:
   - Include decoded packet samples
   - Note differences from WoW structure for translation

4. Create power/ability reference:
   - Mastermind primary/secondary sets
   - Minion types and their attributes
   - How pet commands are encoded

5. Map CoH concepts to WoW equivalents:
   - Archetypes <-> Classes
   - Powersets <-> Talent trees
   - Enhancements <-> Item stats

---

## Resources

- SEGS Project: https://github.com/Segs/Segs
- Homecoming forums and wikis
- Paragon Wiki (archived game documentation)
- CoH Modding communities

---

## Notes

City of Heroes has a more accessible codebase than WoW due to private
server development. This may be the easier protocol to document first.
The translation direction CoH->WoW may be simpler to implement initially.

---

## Sub-Issue Analysis

*Generated by Claude Code on 2025-12-21 00:21*

This is a substantial research issue covering 7 distinct protocol domains, each requiring independent investigation and documentation. The issue would benefit from splitting because:

1. Each protocol domain (auth, world, combat, social, character, mastermind) is largely independent
2. Splitting allows parallel research and clearer progress tracking
3. The packet structure fundamentals should be established first as a foundation

Note: The filename says "201" but the header says "102" - this is a minor inconsistency you may want to resolve.

## Recommended Sub-Issues

| ID | Name | Description |
|----|------|-------------|
| 201a | research-segs-codebase | Clone and analyze SEGS project structure to understand protocol architecture |
| 201b | document-packet-structure | Document base packet format: headers, message types, encoding schemes |
| 201c | document-auth-flow | Research and document login, character selection, and server transfer handshakes |
| 201d | document-world-protocol | Document zone instances, door missions, contact interactions, and map data |
| 201e | document-combat-protocol | Document powers, damage calculations, enhancement effects, and buff/debuff systems |
| 201f | document-social-protocol | Document chat channels, team formation, supergroup data structures |
| 201g | document-character-data | Document archetypes, powersets, slot systems, and costume encoding |
| 201h | document-mastermind-pets | Deep dive into minion commands, pet AI states, and Mastermind-specific mechanics |
| 201i | create-coh-wow-mapping | Map CoH concepts to WoW equivalents for translation layer design |

Sub-issue 201a should be completed first as it provides the codebase context for all subsequent research. Sub-issue 201b should follow, establishing the packet foundation. After that, 201c-201h can proceed somewhat in parallel. Sub-issue 201i depends on having at least 201e-201g completed to create meaningful mappings.

---

## Sub-Issue Analysis

*Generated by Claude Code on 2025-12-21 00:32*

I've read the issue file. Let me analyze it for you.

## Analysis

This issue covers 7 distinct protocol domains plus foundational research work. The scope is substantial - each domain (authentication, world data, combat, social, character data, mastermind-specific, and concept mapping) represents independent research that could take significant time.

I notice the file already contains a sub-issue analysis section at the bottom (generated previously). However, I can offer a refined recommendation.

## Recommendation: Split This Issue

**Reasons to split:**
1. **Independent domains** - Each protocol area (auth, combat, social, etc.) can be researched separately
2. **Clear dependencies** - SEGS codebase analysis must come first, then packet structure, then domain-specific research
3. **Progress visibility** - 9 small completions vs 1 large completion gives better feedback
4. **Parallel work potential** - After foundations are laid, multiple domains can be researched simultaneously

**Minor inconsistency noted:** Filename says `201-` but header says `# 102 -`. I'll use `201` as the parent ID since that matches the filename.

## Recommended Sub-Issues

| ID | Name | Description |
|----|------|-------------|
| 201a | clone-segs-codebase | Clone SEGS project and identify key protocol-handling source files |
| 201b | document-packet-structure | Document base packet format: headers, message types, byte ordering, encoding |
| 201c | document-auth-flow | Research login handshake, character selection, and server transfer sequences |
| 201d | document-world-protocol | Document zone instances, door missions, contacts, and map transitions |
| 201e | document-combat-protocol | Document powers, damage events, enhancements, buffs, and debuffs |
| 201f | document-social-protocol | Document chat channels, team invites, supergroup structures |
| 201g | document-character-data | Document archetypes, powersets, enhancement slots, costume encoding |
| 201h | document-mastermind-pets | Document minion commands, pet AI states, Mastermind-specific packets |
| 201i | create-coh-wow-mapping | Map CoH concepts to WoW equivalents for translation feasibility |

**Dependency chain:** 201a → 201b → (201c through 201h in parallel) → 201i

---

## Sub-Issue Analysis

*Generated by Claude Code on 2025-12-21 00:38*

Looking at this issue, I can see it's already been analyzed previously (there's a sub-issue analysis section at the bottom from an earlier session). Let me provide my own assessment.

## Analysis

This issue covers **7 distinct protocol domains** plus foundational research. The scope is substantial:

- Packet structure (foundational)
- Authentication flow
- World data
- Combat data
- Social data
- Character data
- Mastermind-specific mechanics

**Inconsistency noted:** The filename says `201-` but the header says `# 102 -`. I'm using `201` as the parent ID to match the filename.

## Recommendation: Split This Issue

**Reasons to split:**

1. **Independent research domains** - Each protocol area can be investigated separately without blocking others
2. **Clear dependency chain** - SEGS codebase must be understood before packet structure, which must come before domain-specific research
3. **Better progress tracking** - Completing 9 smaller issues provides clearer visibility than one massive research task
4. **Parallel work potential** - After foundations (a, b), domains c-h can proceed simultaneously

## Recommended Sub-Issues

| ID | Name | Description |
|----|------|-------------|
| 201a | clone-analyze-segs | Clone SEGS project and identify key protocol-handling source files |
| 201b | document-packet-format | Document base packet structure: headers, message types, byte ordering |
| 201c | document-auth-flow | Research login handshake, character selection, server transfers |
| 201d | document-world-data | Document zone instances, door missions, contacts, map transitions |
| 201e | document-combat-data | Document powers, damage events, enhancements, buff/debuff encoding |
| 201f | document-social-data | Document chat channels, team formation, supergroup structures |
| 201g | document-character-data | Document archetypes, powersets, slots, costume encoding |
| 201h | document-mastermind-pets | Document minion commands, pet AI states, Mastermind-specific packets |
| 201i | map-coh-to-wow | Create concept mapping table between CoH and WoW equivalents |

**Dependency chain:** `201a → 201b → (201c-201h parallel) → 201i`
